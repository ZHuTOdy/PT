// Generated by CoffeeScript 2.3.0
(function() {
  var code, init_list, week, weeklyReportTable;

  code = new Vue({
    el: "#code",
    data: {
      props: {
        multiple: true
      },
      options: [
        {
          value: 'all',
          label: '全部',
          children: [
            {
              value: "pro_QY",
              label: '契约',
              children: [
                {
                  value: "B0001",
                  label: 'B0001'
                },
                {
                  value: "B0002",
                  label: 'B0002'
                },
                {
                  value: "B0003",
                  label: 'B0003'
                },
                {
                  value: "B0005",
                  label: 'B0005'
                },
                {
                  value: "B0006",
                  label: 'B0006'
                },
                {
                  value: "B0007",
                  label: 'B0007'
                },
                {
                  value: "B0009",
                  label: 'B0009'
                },
                {
                  value: "B0011",
                  label: 'B0011'
                },
                {
                  value: "B0012",
                  label: 'B0012'
                },
                {
                  value: "B0014",
                  label: 'B0014'
                }
              ]
            },
            {
              value: "pro_BQ",
              label: '保全',
              children: [
                {
                  value: "B0051",
                  label: 'B0051'
                },
                {
                  value: "B0053",
                  label: 'B0053'
                },
                {
                  value: "B0054",
                  label: 'B0054'
                },
                {
                  value: "B0055",
                  label: 'B0055'
                },
                {
                  value: "B0056",
                  label: 'B0056'
                },
                {
                  value: "B0057",
                  label: 'B0057'
                }
              ]
            },
            {
              value: "pro_LP",
              label: '理赔',
              children: [
                {
                  value: "B0101",
                  label: 'B0101'
                },
                {
                  value: "B0103",
                  label: 'B0103'
                },
                {
                  value: "B0106",
                  label: 'B0106'
                },
                {
                  value: "B0110",
                  label: 'B0110'
                },
                {
                  value: "B0111",
                  label: 'B0111'
                },
                {
                  value: "B0113",
                  label: 'B0113'
                },
                {
                  value: "B0114",
                  label: 'B0114'
                }
              ]
            },
            {
              value: "pro_JH",
              label: '交行',
              children: [
                {
                  value: "B0101",
                  label: 'B0101'
                }
              ]
            }
          ]
        }
      ]
    },
    methods: {
      handleChange: function(code) {
        weeklyReport.$data.code = code;
        return init_list();
      }
    }
  });

  week = new Vue({
    el: "#week",
    data: {
      week: ""
    },
    methods: {
      handleChange: function(week) {
        weeklyReport.$data.week = week;
        return init_list();
      }
    }
  });

  // handleChange: ()->
  //   init_list()
  weeklyReportTable = new Vue({
    el: "#weeklyReportTable",
    data: {
      items: [],
      page: 0,
      pageSize: 10,
      total: 0,
      Selection: [],
      code: code.$data.value
    },
    methods: {
      handleSizeChange: function(pageSize) {
        weeklyReportTable.$data.pageSize = pageSize;
        return init_list();
      },
      handleCurrentChange: function(page) {
        weeklyReportTable.$data.page = page;
        return init_list();
      },
      handleSelectionChange: function(val) {
        return this.Selection = val;
      }
    }
  });

  init_list = function() {
    var page, pageSize;
    page = weeklyReportTable.$data.page;
    pageSize = weeklyReportTable.$data.pageSize;
    code = weeklyReport.$data.code;
    week = week.$data.week;
    return socket.emit("report.list", {
      "code": {
        $regex: code
      },
      "week": {
        $regex: week
      }
    }, page, pageSize, function(res) {
      if (res.err) {
        return alert(res.err);
      }
      return Object.assign(weeklyReportTable.$data, res);
    });
  };

  init_list();

}).call(this);
